<?xml version="1.0" encoding="UTF-8"?>
<project name="kitchensynclib" default="compilelib" basedir=".">
	<property file="build.properties" />
	
	<!-- The Title of the Application -->
	<property name="App.title"  value="KitchenSync"/>

	<!-- The Location of FlexSDK on your Computer -->
	<property name="flex.sdkPath" location="${flex.path}/sdks/${flex.sdkVersion}"/>
	<!-- The Location of flex compilers on your Computer -->
	<property name="flex.binaryPath" location="${flex.sdkPath}/bin"/>
	
	<!--
	The Location of your Application Classes on your Computer
	NOTE: This Path should be reletive to the build.xml file.
	NOTE: ${basedir} is an ant property that represents the directory holding the build.xml file
	NOTE: I have encountered issues with this folder containing Spaces
	-->
	<property name="project.sourcePath" location="${basedir}/src"/>
	<property name="project.libraryPath" location="${basedir}/libs"/>
		
	<!--
	The Location you wish to output to on your Computer
	NOTE: I have encountered issues with this folder containing Spaces
	NOTE: This location gets DELETED and re-generated each time the build is run
	-->
	<property name="project.output.docsPath" location="${basedir}/docs/asdoc"/>
	<property name="project.output.binaryPath" location="${basedir}/bin"/>
	
	<!-- Change this to match the current version of KitchenSyncLib -->
	<property name="project.version" value="2.0" />
	
	
	<!--taskdef resource="flexTasks.tasks" classpath="${flex.sdkPath}/lib/flexTasks.jar" /--> 
	<property name="FLEX_HOME" location="${flex.path}" />
	
	<target name="compilelib" description="Compiles the kitchensynclib into a SWC library file">
		<exec executable="${flex.binaryPath}/compc" failonerror="true">
			<arg line="-source-path ${project.sourcePath}" />
			<arg line="-library-path ${project.libraryPath}" />
			<arg line="-include-sources ${project.sourcePath}" />
			<arg line="-output ${project.output.binaryPath}/kitcheynsynclib.swc"/>
		</exec>
		<!--compc output="${project.output.binaryPath}/kitchensynclib.swc"
			   include-classes="${project.sourcePath}">  
			<source-path path-element="${project.sourcePath}" />
		</compc-->
	</target>
	
	<target name="cleandocs" description="Deletes old document files before generating asdocs">
		<delete dir="${project.output.docsPath}" />
		<mkdir dir="${project.output.docsPath}" />
	</target>
	
	<!--
	Run the ASDoc executable and generate the ASDocs to the new output folder
	-->
	<target name="docs" description="Compiles the asdocs in the source code into HTML.">
		<exec executable="${flex.binaryPath}/asdoc" failonerror="true" description="Compiles the asdocs">
			<arg line="-source-path ${project.sourcePath}"/>
			<arg line="-library-path ${project.libraryPath}"/>
			<arg line="-doc-sources ${project.sourcePath}"/>
			<arg line="-window-title &quot;${App.title}&quot;"/>
			<arg line="-output ${project.output.docsPath}"/>
		</exec>
		<exec executable="open" description="Opens the completed file for viewing">
			<arg line="${project.output.docsPath}/index.html" />
		</exec>
	</target>
	
	<target name="exportsource" description="Creates a zip file of the source files for the library">
		<zip 
			destfile="${project.output.binaryPath}/KitchenSyncLib.${project.version}.src.zip" 
			update="true" whenempty="fail"
			>
			<zipfileset dir="src" prefix="src" />
			<zipfileset dir="docs" prefix="docs" />
		</zip>
		<echo message="Created a zip of the source file in the /bin directory." />
	</target>
	
</project>